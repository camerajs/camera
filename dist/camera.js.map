{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/camera.ts","src/events/load.ts","src/lib/browser.ts","src/lib/setCamera.ts","src/lib/utils.ts","src/preferences.ts"],"names":[],"mappings":"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","file":"camera.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import {loadEvent} from \"./events/load\";\r\nimport {preferences} from \"./preferences\";\r\nimport {utils} from \"./lib/utils\";\r\nimport {browser} from \"./lib/browser\";\r\nimport {setCamera} from \"./lib/setCamera\";\r\nimport {upload} from \"./lib/upload\";\r\nclass cameraInitializer {\r\n    constructor() {\r\n        cameraInitializer.ready();\r\n    }\r\n\r\n    static async ready() {\r\n        let loadEventInstancew = new loadEvent();\r\n        //https://github.com/Microsoft/TypeScript/wiki/What's-new-in-TypeScript#downlevel-async-functions\r\n\r\n        await loadEventInstancew.eventListener();\r\n\r\n        if (!preferences.isHttps) {\r\n            utils.log(\"HTTPS required\", \"warn\");\r\n        }\r\n\r\n        if (!browser.checkBrowserSupport()) {\r\n            utils.log(\"Your browser does not support camera\", \"warn\");\r\n        }else{\r\n            //If user browser is supporting camera, then:\r\n            var i=new setCamera();\r\n        }\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\nnew cameraInitializer();\r\n","import {eventInterface} from \"./interface\";\r\nimport {utils} from \"../lib/utils\";\r\nimport {browser} from \"../lib/browser\";\r\nimport {preferences} from \"../preferences\";\r\n\r\nexport class loadEvent implements eventInterface {\r\n\r\n    eventListener() {\r\n        /**\r\n         * This method will be called inside the this.eventCallback method using a async function which means\r\n         *   the method (this.eventCallback) will wait for the answer from evenListener (current method).\r\n         */\r\n        return new Promise<void>(resolve => {\r\n            window.addEventListener(\"load\", () => {\r\n                /**\r\n                 * resolve() will return to result to the async function in its call stack, and will let the function\r\n                 *   continue\r\n                 */\r\n                this.eventCallback();\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    eventCallback() {\r\n        preferences.isHttps = utils.isHttps();\r\n        preferences.isMobile = browser.checkMobile(); //If true, means the user browser is a mobile browser\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n","import {preferences} from \"../preferences\";\r\nexport class browser {\r\n\r\n    static checkBrowserSupport() {\r\n        /**\r\n         * This method will check if the user browser is supporting HTML5 camera API or not\r\n         * The result of the !!(navigator.getUserMedia...) will be true or false\r\n         * Learn more: https://www.html5rocks.com/en/tutorials/getusermedia/intro/\r\n         * Learn more: https://hacks.mozilla.org/2013/02/cross-browser-camera-capture-with-getusermediawebrtc/\r\n         * Solution for old navigator object properties: http://stackoverflow.com/a/13642033/3176270\r\n         **/\r\n        let nav = <any>navigator;\r\n        preferences.browserCameraSupport = !!(nav.getUserMedia || nav.webkitGetUserMedia ||\r\n        nav.mozGetUserMedia || nav.msGetUserMedia);\r\n        return preferences.browserCameraSupport;\r\n    }\r\n\r\n    static checkMobile(): boolean {\r\n        //Return true if the user browser is a mobile browser:\r\n        let check = false;\r\n        (function (a) {\r\n            if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true;\r\n        })(navigator.userAgent || navigator.vendor);\r\n        return check;\r\n    }\r\n}\r\n","import {utils} from \"./utils\";\r\nexport class setCamera {\r\n    constructor() {\r\n        let cameraTags: NodeList = setCamera.getCameraTags();\r\n        if (cameraTags.length) {\r\n            //if any camera tag found:\r\n            this.createCameraView(cameraTags);\r\n        }\r\n    }\r\n\r\n    private static getCameraTags() {\r\n        /**\r\n         * This should be a method, because we will have more things to check for a camera-tag,\r\n         * like some settings & configurations from the camera tag attributes\r\n         **/\r\n        return <NodeList>document.querySelectorAll('[data-camera]');\r\n    }\r\n\r\n    protected createCameraView(cameraTags: any) {\r\n        //Check the number of user camera/audio inputs that are installed into user device (if 0 , it means no camera found):\r\n        setCamera.listCameraAndMicrophones();\r\n\r\n        //loop through founded camera tags, and insert video tag into them (video tag will let us stream camera output)\r\n        for (let i = 0; i < cameraTags.length; i++) {\r\n            let currentCameraTag: HTMLElement = cameraTags[i];\r\n            currentCameraTag.className = 'camerajs-element';\r\n            currentCameraTag.appendChild(setCamera._createVideoElement(i));\r\n            currentCameraTag.appendChild(setCamera._createCanvasElement(i));\r\n            currentCameraTag.appendChild(setCamera._createCameraMenu());\r\n\r\n            //Stream the camera output by a video tag:\r\n            let videoElement: HTMLVideoElement = <HTMLVideoElement>document.getElementById('camerajs-' + i);\r\n            navigator.mediaDevices.getUserMedia({video: true}).then(function (stream) {\r\n                videoElement.src = window.URL.createObjectURL(stream);\r\n                videoElement.play();\r\n            });\r\n\r\n            //Initialize the canvas to put the captured photo into it:\r\n            let canvasElement: HTMLCanvasElement = <HTMLCanvasElement>document.getElementById('camerajs-canvas-' + i);\r\n            let canvasContext: any = canvasElement.getContext('2d');\r\n\r\n            //Capture photo:\r\n            currentCameraTag.querySelector(\".camerajs-menu>a\").addEventListener(\"click\", function () {\r\n                canvasContext.drawImage(videoElement, 0, 0, 640, 480);\r\n            });\r\n        }\r\n    }\r\n\r\n    private static _createVideoElement(elementIndex: number) {\r\n        /*\r\n         * Inside the createCameraView method, we will need to make something that user can see the output of the camera\r\n         *  we need to put a video, canvas tag, and camera main menu (the capture and change camera from rear to front\r\n         *  will be inside menu, also filter and effects) - This method is just for video element and will let user to see\r\n         *  camera output\r\n         * */\r\n        let videoTag: HTMLVideoElement = document.createElement(\"video\");\r\n        videoTag.id = \"camerajs-\" + elementIndex;\r\n        videoTag.setAttribute('width', '640');\r\n        videoTag.setAttribute('height', '480');\r\n        videoTag.setAttribute(\"autoplay\", \"true\");\r\n        return videoTag;\r\n    }\r\n\r\n    private static _createCanvasElement(elementIndex: number) {\r\n        /*\r\n         * Inside the createCameraView method, we will need to make something that user can see the output of the camera\r\n         *  we need to put a video, canvas tag, and camera main menu (the capture and change camera from rear to front\r\n         *  will be inside menu, also filter and effects) - Canvas element will be used when we capture a picture\r\n         * */\r\n        let canvasTag: HTMLCanvasElement = document.createElement(\"canvas\");\r\n        canvasTag.id = \"camerajs-canvas-\" + elementIndex;\r\n        canvasTag.setAttribute('width', '640');\r\n        canvasTag.setAttribute('height', '480');\r\n        return canvasTag;\r\n    }\r\n\r\n    private static _createCameraMenu() {\r\n        /*\r\n         * Inside the createCameraView method, we will need to make something that user can see the output of the camera\r\n         *  we need to put a video, canvas tag, and camera main menu (the capture and change camera from rear to front\r\n         *  will be inside menu, also filter and effects) - The menu of the camera (capture, change camera, etc buttons)\r\n         * */\r\n        //<div class=\"camerajs-menu\"><a>' + svgIconCapture + '</a></div>';\r\n        let menuDivTag: HTMLDivElement = document.createElement(\"div\");\r\n        menuDivTag.className = \"camerajs-menu\";\r\n\r\n        //create the capture button (the svgIconCapture is a capture icon):\r\n        let svgIconCapture: any = '<?xml version=\"1.0\" ?><svg style=\"enable-background:new 0 0 24 24;\" version=\"1.1\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><g id=\"info\"/><g id=\"icons\"><path d=\"M19,7h-0.4c-0.4,0-0.7-0.2-0.9-0.6l-1.2-2.3c-0.3-0.7-1-1.1-1.8-1.1H9.2C8.5,3,7.8,3.4,7.4,4.1L6.3,6.4   C6.1,6.8,5.8,7,5.4,7H5c-2.2,0-4,1.8-4,4v6c0,2.2,1.8,4,4,4h14c2.2,0,4-1.8,4-4v-6C23,8.8,21.2,7,19,7z M12,17c-2.2,0-4-1.8-4-4   c0-2.2,1.8-4,4-4s4,1.8,4,4C16,15.2,14.2,17,12,17z\" id=\"photo\"/></g></svg>';\r\n        let captureButton: HTMLAnchorElement = document.createElement(\"a\");\r\n        captureButton.innerHTML = svgIconCapture;\r\n\r\n        menuDivTag.appendChild(captureButton);\r\n\r\n        return menuDivTag;\r\n    }\r\n\r\n    static listCameraAndMicrophones() {\r\n        let inputs: any = {};\r\n        //This function will return the number of founded cameras and microphones on user's device.\r\n        navigator.mediaDevices.enumerateDevices()\r\n            .then(function (devices: any) {\r\n                devices.forEach(function (device: any) {\r\n                    // inputs[device.kind][deviceCounter]['id'] =   device.deviceId;\r\n                    //inputs[device.kind][deviceCounter]['label'] =   device.label;\r\n                    if (!inputs[device.kind]) {\r\n                        /*\r\n                         * //Initialize the array for, otherwise the .push will returns\r\n                         * \"Error: Cannot read property 'push' of undefined in [null].\"\r\n                         **/\r\n                        inputs[device.kind] = [];\r\n                    }\r\n                    inputs[device.kind].push({label: device.label, deviceId: device.deviceId});\r\n                });\r\n\r\n                //If no video input (webCam) found on user device, console log it\r\n                if (inputs['videoinput'].length == 0) {\r\n                    utils.log(\"No video input found on this device\", 'warn');\r\n                }\r\n                return inputs;\r\n            }).catch(function (err: any) {\r\n            utils.log(err.name + \": \" + err.message, \"warn\");\r\n            return false;\r\n        });\r\n    }\r\n}","import {preferences} from \"../preferences\";\r\n\r\nexport class utils {\r\n    static log(message: string, type?: string): void {\r\n        message = 'Camera.js: '+ message;\r\n        if (preferences.debug) {\r\n            switch (type) {\r\n                case 'warn':\r\n                    console.warn(message);\r\n                    break;\r\n                case 'info':\r\n                    console.info(message);\r\n                    break;\r\n                case 'debug':\r\n                    console.debug(message);\r\n                    break;\r\n                default:\r\n                    console.log(message);\r\n            }\r\n        }\r\n    }\r\n\r\n    static isHttps(){\r\n        return 'https:' == document.location.protocol;\r\n    }\r\n\r\n    /**\r\n     * http://stackoverflow.com/questions/5717093/check-if-a-javascript-string-is-a-url\r\n     * @param url\r\n     * @returns {boolean}\r\n     */\r\n    static validUrl(url:string) {\r\n        let regexp: RegExp = /(ftp|http|https):\\/\\/(\\w+:?\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@\\-\\/]))?/;\r\n        return regexp.test(url);\r\n    }\r\n}","export class preferences{\r\n    static isHttps:boolean = false;\r\n    static isMobile:boolean = false;\r\n    static debug:boolean = true;\r\n    static browserCameraSupport:boolean = false;\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY2FtZXJhLnRzIiwic3JjL2V2ZW50cy9sb2FkLnRzIiwic3JjL2xpYi9icm93c2VyLnRzIiwic3JjL2xpYi9zZXRDYW1lcmEudHMiLCJzcmMvbGliL3V0aWxzLnRzIiwic3JjL3ByZWZlcmVuY2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0FBLHFCQUF3QztBQUN4Qyw0QkFBMEM7QUFDMUMsc0JBQWtDO0FBQ2xDLHdCQUFzQztBQUN0QywwQkFBMEM7QUFFMUM7QUFDSTtBQUNJLEFBQWlCLDBCQUFDLEFBQUssQUFBRSxBQUFDLEFBQzlCO0FBQUM7QUFFWSxzQkFBSyxRQUFsQjs7Z0JBQ1EsQUFBa0Isb0JBYWQsQUFBQzs7Ozs2Q0FiZ0IsSUFBSSxPQUFTLEFBQUU7QUFDeEMsQUFBaUc7QUFFakcsNkNBQU0sQUFBa0IsbUJBQUMsQUFBYSxBQUFFOztBQUZ4QyxBQUFpRztBQUVqRywyQkFBd0MsQUFBQztBQUV6QyxBQUFFLEFBQUMsNEJBQUMsQ0FBQyxjQUFXLFlBQUMsQUFBTyxBQUFDLFNBQUMsQUFBQztBQUN2QixvQ0FBSyxNQUFDLEFBQUcsSUFBQyxBQUFnQixrQkFBRSxBQUFNLEFBQUMsQUFBQyxBQUN4QztBQUFDO0FBRUQsQUFBRSxBQUFDLDRCQUFDLENBQUMsVUFBTyxRQUFDLEFBQW1CLEFBQUUsQUFBQyx1QkFBQyxBQUFDO0FBQ2pDLG9DQUFLLE1BQUMsQUFBRyxJQUFDLEFBQXNDLHdDQUFFLEFBQU0sQUFBQyxBQUFDLEFBQzlEO0FBQUMsQUFBSSwrQkFBQSxBQUFDO2dDQUVJLElBQUksWUFBUyxBQUFFLEFBQ3pCO0FBQUM7Ozs7O0FBSUo7QUFDTCxXQUFBLEFBQUM7QUF6QkQsQUF5QkM7QUFFRCxJQUFJLEFB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aWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IHtsb2FkRXZlbnR9IGZyb20gXCIuL2V2ZW50cy9sb2FkXCI7XHJcbmltcG9ydCB7cHJlZmVyZW5jZXN9IGZyb20gXCIuL3ByZWZlcmVuY2VzXCI7XHJcbmltcG9ydCB7dXRpbHN9IGZyb20gXCIuL2xpYi91dGlsc1wiO1xyXG5pbXBvcnQge2Jyb3dzZXJ9IGZyb20gXCIuL2xpYi9icm93c2VyXCI7XHJcbmltcG9ydCB7c2V0Q2FtZXJhfSBmcm9tIFwiLi9saWIvc2V0Q2FtZXJhXCI7XHJcbmltcG9ydCB7dXBsb2FkfSBmcm9tIFwiLi9saWIvdXBsb2FkXCI7XHJcbmNsYXNzIGNhbWVyYUluaXRpYWxpemVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIGNhbWVyYUluaXRpYWxpemVyLnJlYWR5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGFzeW5jIHJlYWR5KCkge1xyXG4gICAgICAgIGxldCBsb2FkRXZlbnRJbnN0YW5jZXcgPSBuZXcgbG9hZEV2ZW50KCk7XHJcbiAgICAgICAgLy9odHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQvd2lraS9XaGF0J3MtbmV3LWluLVR5cGVTY3JpcHQjZG93bmxldmVsLWFzeW5jLWZ1bmN0aW9uc1xyXG5cclxuICAgICAgICBhd2FpdCBsb2FkRXZlbnRJbnN0YW5jZXcuZXZlbnRMaXN0ZW5lcigpO1xyXG5cclxuICAgICAgICBpZiAoIXByZWZlcmVuY2VzLmlzSHR0cHMpIHtcclxuICAgICAgICAgICAgdXRpbHMubG9nKFwiSFRUUFMgcmVxdWlyZWRcIiwgXCJ3YXJuXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFicm93c2VyLmNoZWNrQnJvd3NlclN1cHBvcnQoKSkge1xyXG4gICAgICAgICAgICB1dGlscy5sb2coXCJZb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBjYW1lcmFcIiwgXCJ3YXJuXCIpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL0lmIHVzZXIgYnJvd3NlciBpcyBzdXBwb3J0aW5nIGNhbWVyYSwgdGhlbjpcclxuICAgICAgICAgICAgdmFyIGk9bmV3IHNldENhbWVyYSgpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgIH1cclxufVxyXG5cclxubmV3IGNhbWVyYUluaXRpYWxpemVyKCk7XHJcbiIsImltcG9ydCB7ZXZlbnRJbnRlcmZhY2V9IGZyb20gXCIuL2ludGVyZmFjZVwiO1xyXG5pbXBvcnQge3V0aWxzfSBmcm9tIFwiLi4vbGliL3V0aWxzXCI7XHJcbmltcG9ydCB7YnJvd3Nlcn0gZnJvbSBcIi4uL2xpYi9icm93c2VyXCI7XHJcbmltcG9ydCB7cHJlZmVyZW5jZXN9IGZyb20gXCIuLi9wcmVmZXJlbmNlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIGxvYWRFdmVudCBpbXBsZW1lbnRzIGV2ZW50SW50ZXJmYWNlIHtcclxuXHJcbiAgICBldmVudExpc3RlbmVyKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgYmUgY2FsbGVkIGluc2lkZSB0aGUgdGhpcy5ldmVudENhbGxiYWNrIG1ldGhvZCB1c2luZyBhIGFzeW5jIGZ1bmN0aW9uIHdoaWNoIG1lYW5zXHJcbiAgICAgICAgICogICB0aGUgbWV0aG9kICh0aGlzLmV2ZW50Q2FsbGJhY2spIHdpbGwgd2FpdCBmb3IgdGhlIGFuc3dlciBmcm9tIGV2ZW5MaXN0ZW5lciAoY3VycmVudCBtZXRob2QpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogcmVzb2x2ZSgpIHdpbGwgcmV0dXJuIHRvIHJlc3VsdCB0byB0aGUgYXN5bmMgZnVuY3Rpb24gaW4gaXRzIGNhbGwgc3RhY2ssIGFuZCB3aWxsIGxldCB0aGUgZnVuY3Rpb25cclxuICAgICAgICAgICAgICAgICAqICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudENhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGV2ZW50Q2FsbGJhY2soKSB7XHJcbiAgICAgICAgcHJlZmVyZW5jZXMuaXNIdHRwcyA9IHV0aWxzLmlzSHR0cHMoKTtcclxuICAgICAgICBwcmVmZXJlbmNlcy5pc01vYmlsZSA9IGJyb3dzZXIuY2hlY2tNb2JpbGUoKTsgLy9JZiB0cnVlLCBtZWFucyB0aGUgdXNlciBicm93c2VyIGlzIGEgbW9iaWxlIGJyb3dzZXJcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbiIsImltcG9ydCB7cHJlZmVyZW5jZXN9IGZyb20gXCIuLi9wcmVmZXJlbmNlc1wiO1xyXG5leHBvcnQgY2xhc3MgYnJvd3NlciB7XHJcblxyXG4gICAgc3RhdGljIGNoZWNrQnJvd3NlclN1cHBvcnQoKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhpcyBtZXRob2Qgd2lsbCBjaGVjayBpZiB0aGUgdXNlciBicm93c2VyIGlzIHN1cHBvcnRpbmcgSFRNTDUgY2FtZXJhIEFQSSBvciBub3RcclxuICAgICAgICAgKiBUaGUgcmVzdWx0IG9mIHRoZSAhIShuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhLi4uKSB3aWxsIGJlIHRydWUgb3IgZmFsc2VcclxuICAgICAgICAgKiBMZWFybiBtb3JlOiBodHRwczovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvZ2V0dXNlcm1lZGlhL2ludHJvL1xyXG4gICAgICAgICAqIExlYXJuIG1vcmU6IGh0dHBzOi8vaGFja3MubW96aWxsYS5vcmcvMjAxMy8wMi9jcm9zcy1icm93c2VyLWNhbWVyYS1jYXB0dXJlLXdpdGgtZ2V0dXNlcm1lZGlhd2VicnRjL1xyXG4gICAgICAgICAqIFNvbHV0aW9uIGZvciBvbGQgbmF2aWdhdG9yIG9iamVjdCBwcm9wZXJ0aWVzOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzY0MjAzMy8zMTc2MjcwXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGxldCBuYXYgPSA8YW55Pm5hdmlnYXRvcjtcclxuICAgICAgICBwcmVmZXJlbmNlcy5icm93c2VyQ2FtZXJhU3VwcG9ydCA9ICEhKG5hdi5nZXRVc2VyTWVkaWEgfHwgbmF2LndlYmtpdEdldFVzZXJNZWRpYSB8fFxyXG4gICAgICAgIG5hdi5tb3pHZXRVc2VyTWVkaWEgfHwgbmF2Lm1zR2V0VXNlck1lZGlhKTtcclxuICAgICAgICByZXR1cm4gcHJlZmVyZW5jZXMuYnJvd3NlckNhbWVyYVN1cHBvcnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNoZWNrTW9iaWxlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vUmV0dXJuIHRydWUgaWYgdGhlIHVzZXIgYnJvd3NlciBpcyBhIG1vYmlsZSBicm93c2VyOlxyXG4gICAgICAgIGxldCBjaGVjayA9IGZhbHNlO1xyXG4gICAgICAgIChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAoLyhhbmRyb2lkfGJiXFxkK3xtZWVnbykuK21vYmlsZXxhdmFudGdvfGJhZGFcXC98YmxhY2tiZXJyeXxibGF6ZXJ8Y29tcGFsfGVsYWluZXxmZW5uZWN8aGlwdG9wfGllbW9iaWxlfGlwKGhvbmV8b2QpfGlyaXN8a2luZGxlfGxnZSB8bWFlbW98bWlkcHxtbXB8bW9iaWxlLitmaXJlZm94fG5ldGZyb250fG9wZXJhIG0ob2J8aW4paXxwYWxtKCBvcyk/fHBob25lfHAoaXhpfHJlKVxcL3xwbHVja2VyfHBvY2tldHxwc3B8c2VyaWVzKDR8NikwfHN5bWJpYW58dHJlb3x1cFxcLihicm93c2VyfGxpbmspfHZvZGFmb25lfHdhcHx3aW5kb3dzIGNlfHhkYXx4aWluby9pLnRlc3QoYSkgfHwgLzEyMDd8NjMxMHw2NTkwfDNnc298NHRocHw1MFsxLTZdaXw3NzBzfDgwMnN8YSB3YXxhYmFjfGFjKGVyfG9vfHNcXC0pfGFpKGtvfHJuKXxhbChhdnxjYXxjbyl8YW1vaXxhbihleHxueXx5dyl8YXB0dXxhcihjaHxnbyl8YXModGV8dXMpfGF0dHd8YXUoZGl8XFwtbXxyIHxzICl8YXZhbnxiZShja3xsbHxucSl8YmkobGJ8cmQpfGJsKGFjfGF6KXxicihlfHYpd3xidW1ifGJ3XFwtKG58dSl8YzU1XFwvfGNhcGl8Y2N3YXxjZG1cXC18Y2VsbHxjaHRtfGNsZGN8Y21kXFwtfGNvKG1wfG5kKXxjcmF3fGRhKGl0fGxsfG5nKXxkYnRlfGRjXFwtc3xkZXZpfGRpY2F8ZG1vYnxkbyhjfHApb3xkcygxMnxcXC1kKXxlbCg0OXxhaSl8ZW0obDJ8dWwpfGVyKGljfGswKXxlc2w4fGV6KFs0LTddMHxvc3x3YXx6ZSl8ZmV0Y3xmbHkoXFwtfF8pfGcxIHV8ZzU2MHxnZW5lfGdmXFwtNXxnXFwtbW98Z28oXFwud3xvZCl8Z3IoYWR8dW4pfGhhaWV8aGNpdHxoZFxcLShtfHB8dCl8aGVpXFwtfGhpKHB0fHRhKXxocCggaXxpcCl8aHNcXC1jfGh0KGMoXFwtfCB8X3xhfGd8cHxzfHQpfHRwKXxodShhd3x0Yyl8aVxcLSgyMHxnb3xtYSl8aTIzMHxpYWMoIHxcXC18XFwvKXxpYnJvfGlkZWF8aWcwMXxpa29tfGltMWt8aW5ub3xpcGFxfGlyaXN8amEodHx2KWF8amJyb3xqZW11fGppZ3N8a2RkaXxrZWppfGtndCggfFxcLyl8a2xvbnxrcHQgfGt3Y1xcLXxreW8oY3xrKXxsZShub3x4aSl8bGcoIGd8XFwvKGt8bHx1KXw1MHw1NHxcXC1bYS13XSl8bGlid3xseW54fG0xXFwtd3xtM2dhfG01MFxcL3xtYSh0ZXx1aXx4byl8bWMoMDF8MjF8Y2EpfG1cXC1jcnxtZShyY3xyaSl8bWkobzh8b2F8dHMpfG1tZWZ8bW8oMDF8MDJ8Yml8ZGV8ZG98dChcXC18IHxvfHYpfHp6KXxtdCg1MHxwMXx2ICl8bXdicHxteXdhfG4xMFswLTJdfG4yMFsyLTNdfG4zMCgwfDIpfG41MCgwfDJ8NSl8bjcoMCgwfDEpfDEwKXxuZSgoY3xtKVxcLXxvbnx0Znx3Znx3Z3x3dCl8bm9rKDZ8aSl8bnpwaHxvMmltfG9wKHRpfHd2KXxvcmFufG93ZzF8cDgwMHxwYW4oYXxkfHQpfHBkeGd8cGcoMTN8XFwtKFsxLThdfGMpKXxwaGlsfHBpcmV8cGwoYXl8dWMpfHBuXFwtMnxwbyhja3xydHxzZSl8cHJveHxwc2lvfHB0XFwtZ3xxYVxcLWF8cWMoMDd8MTJ8MjF8MzJ8NjB8XFwtWzItN118aVxcLSl8cXRla3xyMzgwfHI2MDB8cmFrc3xyaW05fHJvKHZlfHpvKXxzNTVcXC98c2EoZ2V8bWF8bW18bXN8bnl8dmEpfHNjKDAxfGhcXC18b298cFxcLSl8c2RrXFwvfHNlKGMoXFwtfDB8MSl8NDd8bWN8bmR8cmkpfHNnaFxcLXxzaGFyfHNpZShcXC18bSl8c2tcXC0wfHNsKDQ1fGlkKXxzbShhbHxhcnxiM3xpdHx0NSl8c28oZnR8bnkpfHNwKDAxfGhcXC18dlxcLXx2ICl8c3koMDF8bWIpfHQyKDE4fDUwKXx0NigwMHwxMHwxOCl8dGEoZ3R8bGspfHRjbFxcLXx0ZGdcXC18dGVsKGl8bSl8dGltXFwtfHRcXC1tb3x0byhwbHxzaCl8dHMoNzB8bVxcLXxtM3xtNSl8dHhcXC05fHVwKFxcLmJ8ZzF8c2kpfHV0c3R8djQwMHx2NzUwfHZlcml8dmkocmd8dGUpfHZrKDQwfDVbMC0zXXxcXC12KXx2bTQwfHZvZGF8dnVsY3x2eCg1Mnw1M3w2MHw2MXw3MHw4MHw4MXw4M3w4NXw5OCl8dzNjKFxcLXwgKXx3ZWJjfHdoaXR8d2koZyB8bmN8bncpfHdtbGJ8d29udXx4NzAwfHlhc1xcLXx5b3VyfHpldG98enRlXFwtL2kudGVzdChhLnN1YnN0cigwLCA0KSkpIGNoZWNrID0gdHJ1ZTtcclxuICAgICAgICB9KShuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IpO1xyXG4gICAgICAgIHJldHVybiBjaGVjaztcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge3V0aWxzfSBmcm9tIFwiLi91dGlsc1wiO1xyXG5leHBvcnQgY2xhc3Mgc2V0Q2FtZXJhIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIGxldCBjYW1lcmFUYWdzOiBOb2RlTGlzdCA9IHNldENhbWVyYS5nZXRDYW1lcmFUYWdzKCk7XHJcbiAgICAgICAgaWYgKGNhbWVyYVRhZ3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vaWYgYW55IGNhbWVyYSB0YWcgZm91bmQ6XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQ2FtZXJhVmlldyhjYW1lcmFUYWdzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2V0Q2FtZXJhVGFncygpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGlzIHNob3VsZCBiZSBhIG1ldGhvZCwgYmVjYXVzZSB3ZSB3aWxsIGhhdmUgbW9yZSB0aGluZ3MgdG8gY2hlY2sgZm9yIGEgY2FtZXJhLXRhZyxcclxuICAgICAgICAgKiBsaWtlIHNvbWUgc2V0dGluZ3MgJiBjb25maWd1cmF0aW9ucyBmcm9tIHRoZSBjYW1lcmEgdGFnIGF0dHJpYnV0ZXNcclxuICAgICAgICAgKiovXHJcbiAgICAgICAgcmV0dXJuIDxOb2RlTGlzdD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1jYW1lcmFdJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUNhbWVyYVZpZXcoY2FtZXJhVGFnczogYW55KSB7XHJcbiAgICAgICAgLy9DaGVjayB0aGUgbnVtYmVyIG9mIHVzZXIgY2FtZXJhL2F1ZGlvIGlucHV0cyB0aGF0IGFyZSBpbnN0YWxsZWQgaW50byB1c2VyIGRldmljZSAoaWYgMCAsIGl0IG1lYW5zIG5vIGNhbWVyYSBmb3VuZCk6XHJcbiAgICAgICAgc2V0Q2FtZXJhLmxpc3RDYW1lcmFBbmRNaWNyb3Bob25lcygpO1xyXG5cclxuICAgICAgICAvL2xvb3AgdGhyb3VnaCBmb3VuZGVkIGNhbWVyYSB0YWdzLCBhbmQgaW5zZXJ0IHZpZGVvIHRhZyBpbnRvIHRoZW0gKHZpZGVvIHRhZyB3aWxsIGxldCB1cyBzdHJlYW0gY2FtZXJhIG91dHB1dClcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhbWVyYVRhZ3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRDYW1lcmFUYWc6IEhUTUxFbGVtZW50ID0gY2FtZXJhVGFnc1tpXTtcclxuICAgICAgICAgICAgY3VycmVudENhbWVyYVRhZy5jbGFzc05hbWUgPSAnY2FtZXJhanMtZWxlbWVudCc7XHJcbiAgICAgICAgICAgIGN1cnJlbnRDYW1lcmFUYWcuYXBwZW5kQ2hpbGQoc2V0Q2FtZXJhLl9jcmVhdGVWaWRlb0VsZW1lbnQoaSkpO1xyXG4gICAgICAgICAgICBjdXJyZW50Q2FtZXJhVGFnLmFwcGVuZENoaWxkKHNldENhbWVyYS5fY3JlYXRlQ2FudmFzRWxlbWVudChpKSk7XHJcbiAgICAgICAgICAgIGN1cnJlbnRDYW1lcmFUYWcuYXBwZW5kQ2hpbGQoc2V0Q2FtZXJhLl9jcmVhdGVDYW1lcmFNZW51KCkpO1xyXG5cclxuICAgICAgICAgICAgLy9TdHJlYW0gdGhlIGNhbWVyYSBvdXRwdXQgYnkgYSB2aWRlbyB0YWc6XHJcbiAgICAgICAgICAgIGxldCB2aWRlb0VsZW1lbnQ6IEhUTUxWaWRlb0VsZW1lbnQgPSA8SFRNTFZpZGVvRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FtZXJhanMtJyArIGkpO1xyXG4gICAgICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7dmlkZW86IHRydWV9KS50aGVuKGZ1bmN0aW9uIChzdHJlYW0pIHtcclxuICAgICAgICAgICAgICAgIHZpZGVvRWxlbWVudC5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pO1xyXG4gICAgICAgICAgICAgICAgdmlkZW9FbGVtZW50LnBsYXkoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvL0luaXRpYWxpemUgdGhlIGNhbnZhcyB0byBwdXQgdGhlIGNhcHR1cmVkIHBob3RvIGludG8gaXQ6XHJcbiAgICAgICAgICAgIGxldCBjYW52YXNFbGVtZW50OiBIVE1MQ2FudmFzRWxlbWVudCA9IDxIVE1MQ2FudmFzRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FtZXJhanMtY2FudmFzLScgKyBpKTtcclxuICAgICAgICAgICAgbGV0IGNhbnZhc0NvbnRleHQ6IGFueSA9IGNhbnZhc0VsZW1lbnQuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgIC8vQ2FwdHVyZSBwaG90bzpcclxuICAgICAgICAgICAgY3VycmVudENhbWVyYVRhZy5xdWVyeVNlbGVjdG9yKFwiLmNhbWVyYWpzLW1lbnU+YVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzQ29udGV4dC5kcmF3SW1hZ2UodmlkZW9FbGVtZW50LCAwLCAwLCA2NDAsIDQ4MCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBfY3JlYXRlVmlkZW9FbGVtZW50KGVsZW1lbnRJbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiBJbnNpZGUgdGhlIGNyZWF0ZUNhbWVyYVZpZXcgbWV0aG9kLCB3ZSB3aWxsIG5lZWQgdG8gbWFrZSBzb21ldGhpbmcgdGhhdCB1c2VyIGNhbiBzZWUgdGhlIG91dHB1dCBvZiB0aGUgY2FtZXJhXHJcbiAgICAgICAgICogIHdlIG5lZWQgdG8gcHV0IGEgdmlkZW8sIGNhbnZhcyB0YWcsIGFuZCBjYW1lcmEgbWFpbiBtZW51ICh0aGUgY2FwdHVyZSBhbmQgY2hhbmdlIGNhbWVyYSBmcm9tIHJlYXIgdG8gZnJvbnRcclxuICAgICAgICAgKiAgd2lsbCBiZSBpbnNpZGUgbWVudSwgYWxzbyBmaWx0ZXIgYW5kIGVmZmVjdHMpIC0gVGhpcyBtZXRob2QgaXMganVzdCBmb3IgdmlkZW8gZWxlbWVudCBhbmQgd2lsbCBsZXQgdXNlciB0byBzZWVcclxuICAgICAgICAgKiAgY2FtZXJhIG91dHB1dFxyXG4gICAgICAgICAqICovXHJcbiAgICAgICAgbGV0IHZpZGVvVGFnOiBIVE1MVmlkZW9FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xyXG4gICAgICAgIHZpZGVvVGFnLmlkID0gXCJjYW1lcmFqcy1cIiArIGVsZW1lbnRJbmRleDtcclxuICAgICAgICB2aWRlb1RhZy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzY0MCcpO1xyXG4gICAgICAgIHZpZGVvVGFnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzQ4MCcpO1xyXG4gICAgICAgIHZpZGVvVGFnLnNldEF0dHJpYnV0ZShcImF1dG9wbGF5XCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICByZXR1cm4gdmlkZW9UYWc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2NyZWF0ZUNhbnZhc0VsZW1lbnQoZWxlbWVudEluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIEluc2lkZSB0aGUgY3JlYXRlQ2FtZXJhVmlldyBtZXRob2QsIHdlIHdpbGwgbmVlZCB0byBtYWtlIHNvbWV0aGluZyB0aGF0IHVzZXIgY2FuIHNlZSB0aGUgb3V0cHV0IG9mIHRoZSBjYW1lcmFcclxuICAgICAgICAgKiAgd2UgbmVlZCB0byBwdXQgYSB2aWRlbywgY2FudmFzIHRhZywgYW5kIGNhbWVyYSBtYWluIG1lbnUgKHRoZSBjYXB0dXJlIGFuZCBjaGFuZ2UgY2FtZXJhIGZyb20gcmVhciB0byBmcm9udFxyXG4gICAgICAgICAqICB3aWxsIGJlIGluc2lkZSBtZW51LCBhbHNvIGZpbHRlciBhbmQgZWZmZWN0cykgLSBDYW52YXMgZWxlbWVudCB3aWxsIGJlIHVzZWQgd2hlbiB3ZSBjYXB0dXJlIGEgcGljdHVyZVxyXG4gICAgICAgICAqICovXHJcbiAgICAgICAgbGV0IGNhbnZhc1RhZzogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIGNhbnZhc1RhZy5pZCA9IFwiY2FtZXJhanMtY2FudmFzLVwiICsgZWxlbWVudEluZGV4O1xyXG4gICAgICAgIGNhbnZhc1RhZy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzY0MCcpO1xyXG4gICAgICAgIGNhbnZhc1RhZy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICc0ODAnKTtcclxuICAgICAgICByZXR1cm4gY2FudmFzVGFnO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIF9jcmVhdGVDYW1lcmFNZW51KCkge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogSW5zaWRlIHRoZSBjcmVhdGVDYW1lcmFWaWV3IG1ldGhvZCwgd2Ugd2lsbCBuZWVkIHRvIG1ha2Ugc29tZXRoaW5nIHRoYXQgdXNlciBjYW4gc2VlIHRoZSBvdXRwdXQgb2YgdGhlIGNhbWVyYVxyXG4gICAgICAgICAqICB3ZSBuZWVkIHRvIHB1dCBhIHZpZGVvLCBjYW52YXMgdGFnLCBhbmQgY2FtZXJhIG1haW4gbWVudSAodGhlIGNhcHR1cmUgYW5kIGNoYW5nZSBjYW1lcmEgZnJvbSByZWFyIHRvIGZyb250XHJcbiAgICAgICAgICogIHdpbGwgYmUgaW5zaWRlIG1lbnUsIGFsc28gZmlsdGVyIGFuZCBlZmZlY3RzKSAtIFRoZSBtZW51IG9mIHRoZSBjYW1lcmEgKGNhcHR1cmUsIGNoYW5nZSBjYW1lcmEsIGV0YyBidXR0b25zKVxyXG4gICAgICAgICAqICovXHJcbiAgICAgICAgLy88ZGl2IGNsYXNzPVwiY2FtZXJhanMtbWVudVwiPjxhPicgKyBzdmdJY29uQ2FwdHVyZSArICc8L2E+PC9kaXY+JztcclxuICAgICAgICBsZXQgbWVudURpdlRhZzogSFRNTERpdkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIG1lbnVEaXZUYWcuY2xhc3NOYW1lID0gXCJjYW1lcmFqcy1tZW51XCI7XHJcblxyXG4gICAgICAgIC8vY3JlYXRlIHRoZSBjYXB0dXJlIGJ1dHRvbiAodGhlIHN2Z0ljb25DYXB0dXJlIGlzIGEgY2FwdHVyZSBpY29uKTpcclxuICAgICAgICBsZXQgc3ZnSWNvbkNhcHR1cmU6IGFueSA9ICc8P3htbCB2ZXJzaW9uPVwiMS4wXCIgPz48c3ZnIHN0eWxlPVwiZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDtcIiB2ZXJzaW9uPVwiMS4xXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHhtbDpzcGFjZT1cInByZXNlcnZlXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHhtbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiPjxnIGlkPVwiaW5mb1wiLz48ZyBpZD1cImljb25zXCI+PHBhdGggZD1cIk0xOSw3aC0wLjRjLTAuNCwwLTAuNy0wLjItMC45LTAuNmwtMS4yLTIuM2MtMC4zLTAuNy0xLTEuMS0xLjgtMS4xSDkuMkM4LjUsMyw3LjgsMy40LDcuNCw0LjFMNi4zLDYuNCAgIEM2LjEsNi44LDUuOCw3LDUuNCw3SDVjLTIuMiwwLTQsMS44LTQsNHY2YzAsMi4yLDEuOCw0LDQsNGgxNGMyLjIsMCw0LTEuOCw0LTR2LTZDMjMsOC44LDIxLjIsNywxOSw3eiBNMTIsMTdjLTIuMiwwLTQtMS44LTQtNCAgIGMwLTIuMiwxLjgtNCw0LTRzNCwxLjgsNCw0QzE2LDE1LjIsMTQuMiwxNywxMiwxN3pcIiBpZD1cInBob3RvXCIvPjwvZz48L3N2Zz4nO1xyXG4gICAgICAgIGxldCBjYXB0dXJlQnV0dG9uOiBIVE1MQW5jaG9yRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgICAgIGNhcHR1cmVCdXR0b24uaW5uZXJIVE1MID0gc3ZnSWNvbkNhcHR1cmU7XHJcblxyXG4gICAgICAgIG1lbnVEaXZUYWcuYXBwZW5kQ2hpbGQoY2FwdHVyZUJ1dHRvbik7XHJcblxyXG4gICAgICAgIHJldHVybiBtZW51RGl2VGFnO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBsaXN0Q2FtZXJhQW5kTWljcm9waG9uZXMoKSB7XHJcbiAgICAgICAgbGV0IGlucHV0czogYW55ID0ge307XHJcbiAgICAgICAgLy9UaGlzIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIHRoZSBudW1iZXIgb2YgZm91bmRlZCBjYW1lcmFzIGFuZCBtaWNyb3Bob25lcyBvbiB1c2VyJ3MgZGV2aWNlLlxyXG4gICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkZXZpY2VzOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgIGRldmljZXMuZm9yRWFjaChmdW5jdGlvbiAoZGV2aWNlOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbnB1dHNbZGV2aWNlLmtpbmRdW2RldmljZUNvdW50ZXJdWydpZCddID0gICBkZXZpY2UuZGV2aWNlSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9pbnB1dHNbZGV2aWNlLmtpbmRdW2RldmljZUNvdW50ZXJdWydsYWJlbCddID0gICBkZXZpY2UubGFiZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbnB1dHNbZGV2aWNlLmtpbmRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIC8vSW5pdGlhbGl6ZSB0aGUgYXJyYXkgZm9yLCBvdGhlcndpc2UgdGhlIC5wdXNoIHdpbGwgcmV0dXJuc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBcIkVycm9yOiBDYW5ub3QgcmVhZCBwcm9wZXJ0eSAncHVzaCcgb2YgdW5kZWZpbmVkIGluIFtudWxsXS5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiovXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c1tkZXZpY2Uua2luZF0gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRzW2RldmljZS5raW5kXS5wdXNoKHtsYWJlbDogZGV2aWNlLmxhYmVsLCBkZXZpY2VJZDogZGV2aWNlLmRldmljZUlkfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL0lmIG5vIHZpZGVvIGlucHV0ICh3ZWJDYW0pIGZvdW5kIG9uIHVzZXIgZGV2aWNlLCBjb25zb2xlIGxvZyBpdFxyXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0c1sndmlkZW9pbnB1dCddLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbHMubG9nKFwiTm8gdmlkZW8gaW5wdXQgZm91bmQgb24gdGhpcyBkZXZpY2VcIiwgJ3dhcm4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dHM7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnI6IGFueSkge1xyXG4gICAgICAgICAgICB1dGlscy5sb2coZXJyLm5hbWUgKyBcIjogXCIgKyBlcnIubWVzc2FnZSwgXCJ3YXJuXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge3ByZWZlcmVuY2VzfSBmcm9tIFwiLi4vcHJlZmVyZW5jZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyB1dGlscyB7XHJcbiAgICBzdGF0aWMgbG9nKG1lc3NhZ2U6IHN0cmluZywgdHlwZT86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIG1lc3NhZ2UgPSAnQ2FtZXJhLmpzOiAnKyBtZXNzYWdlO1xyXG4gICAgICAgIGlmIChwcmVmZXJlbmNlcy5kZWJ1Zykge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3dhcm4nOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2luZm8nOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhtZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlYnVnJzpcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgaXNIdHRwcygpe1xyXG4gICAgICAgIHJldHVybiAnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTcxNzA5My9jaGVjay1pZi1hLWphdmFzY3JpcHQtc3RyaW5nLWlzLWEtdXJsXHJcbiAgICAgKiBAcGFyYW0gdXJsXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIHZhbGlkVXJsKHVybDpzdHJpbmcpIHtcclxuICAgICAgICBsZXQgcmVnZXhwOiBSZWdFeHAgPSAvKGZ0cHxodHRwfGh0dHBzKTpcXC9cXC8oXFx3Kzo/XFx3KkApPyhcXFMrKSg6WzAtOV0rKT8oXFwvfFxcLyhbXFx3IyE6Lj8rPSYlQFxcLVxcL10pKT8vO1xyXG4gICAgICAgIHJldHVybiByZWdleHAudGVzdCh1cmwpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIHByZWZlcmVuY2Vze1xyXG4gICAgc3RhdGljIGlzSHR0cHM6Ym9vbGVhbiA9IGZhbHNlO1xyXG4gICAgc3RhdGljIGlzTW9iaWxlOmJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHN0YXRpYyBkZWJ1Zzpib29sZWFuID0gdHJ1ZTtcclxuICAgIHN0YXRpYyBicm93c2VyQ2FtZXJhU3VwcG9ydDpib29sZWFuID0gZmFsc2U7XHJcbn1cclxuIl19"}